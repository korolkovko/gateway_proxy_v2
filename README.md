# Payment Gateway Proxy

–ü—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–≤—è–∑–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —à–ª—é–∑–∞ —Å –æ–±–ª–∞—á–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º —á–µ—Ä–µ–∑ WebSocket.

## üìã –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä —Ä—è–¥–æ–º —Å –ø–ª–∞—Ç–µ–∂–Ω—ã–º —à–ª—é–∑–æ–º –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:

1. **–ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –æ–±–ª–∞—á–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É** —á–µ—Ä–µ–∑ WebSocket
2. **–ü–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –æ–ø–ª–∞—Ç—É** –æ—Ç –æ–±–ª–∞—á–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
3. **–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç WebSocket —Å–æ–æ–±—â–µ–Ω–∏—è** –≤ HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —à–ª—é–∑—É
4. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç—ã** –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ –æ–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è** –ø—Ä–∏ –æ–±—Ä—ã–≤–µ —Å–≤—è–∑–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Cloud Server   ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ WebSocket ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ  Proxy Service   ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ HTTP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ Payment Gateway ‚îÇ
‚îÇ   (Railway)     ‚îÇ                    ‚îÇ  (This service)  ‚îÇ                    ‚îÇ  (localhost)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
   wss://...                              gateway_proxy/                         http://localhost:8080
```

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **OS**: Linux / macOS / Windows
- **Python**: 3.11 –∏–ª–∏ –≤—ã—à–µ
- **–ò–Ω—Ç–µ—Ä–Ω–µ—Ç**: –°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –æ–±–ª–∞—á–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º
- **–õ–æ–∫–∞–ª—å–Ω—ã–π —à–ª—é–∑**: –ó–∞–ø—É—â–µ–Ω–Ω—ã–π –ø–ª–∞—Ç–µ–∂–Ω—ã–π —à–ª—é–∑ –Ω–∞ `localhost:8080`

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å—é –ø–∞–ø–∫—É `gateway_proxy/` –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä —Å –ø–ª–∞—Ç–µ–∂–Ω—ã–º —à–ª—é–∑–æ–º.

### 2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
cd gateway_proxy
cp .env.example .env
```

### 3. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`

–û—Ç–∫—Ä–æ–π—Ç–µ `.env` –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –ü–æ–ª—É—á–∏—Ç–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞: /add_kiosk
CLOUD_WS_URL="wss://web-production-efee8.up.railway.app/ws/KIOSK_001"
CLOUD_WS_TOKEN="your_jwt_token_from_bot"
KIOSK_ID="KIOSK_001"

# URL –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —à–ª—é–∑–∞ (–æ–±—ã—á–Ω–æ –Ω–µ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å)
LOCAL_GATEWAY_URL="http://localhost:8080"

# –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (DEBUG –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏, INFO –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
LOG_LEVEL="INFO"
```

### 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

#### –ù–∞ Linux/macOS:

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
./start_proxy.sh
```

#### –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python3 -m venv venv
source venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt
```

#### –ù–∞ Windows:

```powershell
# –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv venv
venv\Scripts\activate

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt
```

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç (Linux/macOS)

```bash
./start_proxy.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –í—Ä—É—á–Ω—É—é

```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate  # Linux/macOS
# –∏–ª–∏
venv\Scripts\activate  # Windows

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export $(cat .env | grep -v '^#' | xargs)  # Linux/macOS
# –∏–ª–∏ –≤—Ä—É—á–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞ Windows

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–∫—Å–∏
python3 proxy.py
```

## üìä –ß—Ç–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

```
üöÄ Payment Gateway Proxy starting...
   Kiosk ID: KIOSK_001
   Cloud URL: wss://web-production-efee8.up.railway.app/ws/KIOSK_001
   Local Gateway: http://localhost:8080
üîå Connecting to cloud server...
‚úÖ Connected to cloud server
üì° Connection status: connected
```

## üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:

1. **–û–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä ‚Üí –ü—Ä–æ–∫—Å–∏** (WebSocket):
```json
{
  "type": "payment_request",
  "data": {
    "request_id": "REQ_ABC123",
    "kiosk_id": "KIOSK_001",
    "order_id": 9999995,
    "sum": 150000
  }
}
```

2. **–ü—Ä–æ–∫—Å–∏ ‚Üí –õ–æ–∫–∞–ª—å–Ω—ã–π —à–ª—é–∑** (HTTP POST):
```json
POST http://localhost:8080/payment
{
  "kiosk_id": "kiosk_001",
  "order_id": 9999995,
  "sum": 150000
}
```

3. **–õ–æ–∫–∞–ª—å–Ω—ã–π —à–ª—é–∑ ‚Üí –ü—Ä–æ–∫—Å–∏** (HTTP Response):
```json
{
  "status": "success",
  "sum": 150000,
  "currency": "RUB",
  "payment_method": "card",
  ...
}
```

4. **–ü—Ä–æ–∫—Å–∏ ‚Üí –û–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä** (WebSocket):
```json
{
  "type": "payment_response",
  "data": {
    "request_id": "REQ_ABC123",
    "status": "SUCCESS",
    "sum": 150000,
    "currency": "RUB",
    "payment_method": "card",
    "timestamp": "2025-10-01T12:00:00Z",
    "payment_data": { ... }
  }
}
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–∫—Å–∏ —Å–æ–∑–¥–∞–µ—Ç –ª–æ–≥-—Ñ–∞–π–ª—ã —Å –∏–º–µ–Ω–µ–º `gateway_proxy_YYYYMMDD.log` –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

```bash
tail -f gateway_proxy_$(date +%Y%m%d).log
```

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

- **DEBUG**: –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –¥–µ—Ç–∞–ª–∏ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
- **INFO**: –û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –ø–ª–∞—Ç–µ–∂–∏)
- **WARNING**: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- **ERROR**: –û—à–∏–±–∫–∏

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### ‚ùå –û—à–∏–±–∫–∞: "CLOUD_WS_URL not set"

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª .env
cat .env

# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
export $(cat .env | grep -v '^#' | xargs)
```

### ‚ùå –û—à–∏–±–∫–∞: "Connection failed: HTTP 403"

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω –∏–ª–∏ –∫–∏–æ—Å–∫ –Ω–µ —Å–æ–∑–¥–∞–Ω

**–†–µ—à–µ–Ω–∏–µ**:
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–∏–æ—Å–∫ –≤ Telegram –±–æ—Ç–µ: `/add_kiosk`
2. –û–±–Ω–æ–≤–∏—Ç–µ `CLOUD_WS_TOKEN` –∏ `CLOUD_WS_URL` –≤ `.env`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–∫—Å–∏

### ‚ùå –û—à–∏–±–∫–∞: "Error communicating with local gateway"

**–ü—Ä–æ–±–ª–µ–º–∞**: –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–ª–∞—Ç–µ–∂–Ω—ã–π —à–ª—é–∑ –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–ª–∞—Ç–µ–∂–Ω—ã–π —à–ª—é–∑ –∑–∞–ø—É—â–µ–Ω:
```bash
curl http://localhost:8080/health
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç –≤ `.env` (`LOCAL_GATEWAY_URL`)

3. –ï—Å–ª–∏ –ø–ª–∞—Ç–µ–∂–Ω—ã–π —à–ª—é–∑ –Ω–∞ –¥—Ä—É–≥–æ–º –ø–æ—Ä—Ç—É, –∏–∑–º–µ–Ω–∏—Ç–µ URL:
```bash
LOCAL_GATEWAY_URL="http://localhost:8010"
```

### ‚ùå –û—à–∏–±–∫–∞: "Connection lost. Reconnecting..."

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ—Ç–µ—Ä—è–Ω–∞ —Å–≤—è–∑—å —Å –æ–±–ª–∞—á–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–∫—Å–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥. –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–ü—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ (Ctrl+C) –ø—Ä–æ–∫—Å–∏ –≤—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:

```
==================================================
üìä Proxy Statistics:
   Messages received: 145
   Messages sent: 143
   HTTP requests: 72
   HTTP errors: 2
   Reconnections: 1
==================================================
```

## üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞

–ù–∞–∂–º–∏—Ç–µ **Ctrl+C** –¥–ª—è graceful shutdown

## üîÑ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ (Linux)

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã —Å–æ–∑–¥–∞–π—Ç–µ systemd service:

### 1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª service:

```bash
sudo nano /etc/systemd/system/gateway-proxy.service
```

### 2. –î–æ–±–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```ini
[Unit]
Description=Payment Gateway Proxy
After=network.target

[Service]
Type=simple
User=your_username
WorkingDirectory=/path/to/gateway_proxy
ExecStart=/path/to/gateway_proxy/start_proxy.sh
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

### 3. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ:

```bash
sudo systemctl daemon-reload
sudo systemctl enable gateway-proxy
sudo systemctl start gateway-proxy

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
sudo systemctl status gateway-proxy

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo journalctl -u gateway-proxy -f
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –æ–±–ª–∞–∫—É

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–∫—Å–∏
./start_proxy.sh

# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# ‚úÖ Connected to cloud server
```

### –¢–µ—Å—Ç 2: –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞

1. –í Telegram –±–æ—Ç–µ: `/send_payment`
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –∫–∏–æ—Å–∫
3. –í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É: `1000`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–æ–∫—Å–∏ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
üì• Received from cloud: payment_request
üí≥ Processing payment request: REQ_...
üì® Sending HTTP request to local gateway: Order #..., Amount: 100000
```

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –±–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —à–ª—é–∑–∞

–ï—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π —à–ª—é–∑ –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤, –ø—Ä–æ–∫—Å–∏ –≤—Å–µ —Ä–∞–≤–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ –æ–±–ª–∞–∫—É –∏ –±—É–¥–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∫ —à–ª—é–∑—É.

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –õ–æ–≥–∏ –ø—Ä–æ–∫—Å–∏: `tail -f gateway_proxy_*.log`
2. –°—Ç–∞—Ç—É—Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —à–ª—é–∑–∞: `curl http://localhost:8080/health`
3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: `cat .env`

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ** —Ñ–∞–π–ª `.env` —Å —Ç–æ–∫–µ–Ω–∞–º–∏
- **–•—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã** –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ
- **–¢–æ–∫–µ–Ω—ã –∏—Å—Ç–µ–∫–∞—é—Ç** —á–µ—Ä–µ–∑ 30 –¥–Ω–µ–π - —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–∏–æ—Å–∫ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ü—Ä–æ–∫—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ** –∏ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–µ –ø–æ—Ä—Ç—ã

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
gateway_proxy/
‚îú‚îÄ‚îÄ proxy.py              # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–æ–∫—Å–∏
‚îú‚îÄ‚îÄ requirements.txt      # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env.example         # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ .env                 # –í–∞—à–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ù–ï –ö–û–ú–ò–¢–ò–¢–¨!)
‚îú‚îÄ‚îÄ start_proxy.sh       # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ (Linux/macOS)
‚îú‚îÄ‚îÄ README.md            # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ gateway_proxy_*.log  # –õ–æ–≥–∏ (—Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–ü—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!

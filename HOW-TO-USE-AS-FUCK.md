# üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å Gateway Proxy - –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## –ó–∞–ø—É—Å–∫ —Å –Ω—É–ª—è (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd /Users/korolkovnikolai/gateway_proxy_v2/
python3 -m venv venv
./venv/bin/pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–∞–º –∑–∞–ø–æ–ª–Ω–µ–Ω–æ:

```bash
WS_SERVER_URL='wss://web-production-a21a7.up.railway.app/ws'
WS_TOKEN='–≤–∞—à_—Ç–æ–∫–µ–Ω'
LOG_LEVEL='INFO'
```

### 3. –ó–∞–ø—É—Å–∫ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

```bash
./venv/bin/python monitor.py
```

### 4. –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "‚ñ∂ START"

–ì–æ—Ç–æ–≤–æ! –ü—Ä–æ–∫—Å–∏ –∑–∞–ø—É—â–µ–Ω.

---

## –û–±—ã—á–Ω—ã–π –∑–∞–ø—É—Å–∫ (–Ω–µ –ø–µ—Ä–≤—ã–π —Ä–∞–∑)

```bash
cd /Users/korolkovnikolai/gateway_proxy_v2/
./venv/bin/python monitor.py
```

–ù–∞–∂–º–∏—Ç–µ "‚ñ∂ START" –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

---

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- **Control** (–∫–ª–∞–≤–∏—à–∞ `1`) - –∑–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–∫—Å–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **Logs** (–∫–ª–∞–≤–∏—à–∞ `2`) - –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **Settings** (–∫–ª–∞–≤–∏—à–∞ `3`) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WS —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Ç–æ–∫–µ–Ω–∞
- **Routes** (–∫–ª–∞–≤–∏—à–∞ `4`) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—É—Ç–∏–Ω–≥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

### –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- `‚ñ∂ START` - –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–∫—Å–∏
- `‚ñ† STOP` - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–∫—Å–∏
- `‚Üª RESTART` - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–∫—Å–∏

### –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:
- `q` - –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã

---

## –ó–∞–ø—É—Å–∫ –±–µ–∑ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–∫–æ–Ω—Å–æ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º)

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–æ–∫—Å–∏ –±–µ–∑ TUI:

```bash
./venv/bin/python proxy.py
```

---

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–∫—Å–∏

1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ WebSocket —Å–µ—Ä–≤–µ—Ä—É (`WS_SERVER_URL`)
2. –ê–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω–æ–º (`WS_TOKEN`)
3. –ü–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
4. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ping/pong (`{"type": "ping"}` ‚Üí `{"type": "pong"}`)
5. –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π gateway –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –∏–∑ `routing_config.yaml`
6. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç—ã –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
üöÄ Payment Gateway Proxy starting...
   WS Server: wss://web-production-a21a7.up.railway.app/ws
   Routing config loaded with X routes
‚úÖ Connected to cloud server
```

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∂–µ—Ç:
- RECEIVED - —Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—É—á–µ–Ω–æ
- SENT - —Å–∫–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
- ERRORS - —Å–∫–æ–ª—å–∫–æ –æ—à–∏–±–æ–∫

---

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ù–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è venv
```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
rm -rf venv
python3 -m venv venv
./venv/bin/pip install -r requirements.txt
```

### –û—à–∏–±–∫–∞ "Connection failed"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `WS_SERVER_URL` –≤ `.env`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç–æ–∫–µ–Ω –Ω–µ –∏—Å—Ç–µ–∫

### –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ gateway
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ª–æ–∫–∞–ª—å–Ω—ã–π gateway –∑–∞–ø—É—â–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤ `routing_config.yaml`

---

## –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

- `.env` - –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (URL —Å–µ—Ä–≤–µ—Ä–∞, —Ç–æ–∫–µ–Ω)
- `routing_config.yaml` - –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –∫ gateway
- `proxy_YYYYMMDD.log` - –ª–æ–≥–∏ —Ä–∞–±–æ—Ç—ã (—Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

---

## –ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ (–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π)

```bash
cd /Users/korolkovnikolai/gateway_proxy_v2/ && ./venv/bin/python monitor.py
```
